---
/**
 * PropTable Component
 * 
 * Renders auto-generated prop documentation from JSON files.
 * Usage: <PropTable component="button" />
 */

interface Props {
	component: string;
}

interface PropDefinition {
	name: string;
	type: string;
	required: boolean;
	defaultValue: string | null;
	description: string;
}

interface ComponentDoc {
	name: string;
	description: string;
	props: PropDefinition[];
}

const { component } = Astro.props;

let doc: ComponentDoc | null = null;
let error: string | null = null;

try {
	// Import the generated JSON file
	const propsModule = await import(`../../props/${component}.json`);
	doc = propsModule.default as ComponentDoc;
} catch (e) {
	error = `Props not found for component "${component}". Run \`bun run generate-props\` to generate.`;
}
---

{error ? (
	<div class="prop-table-error">
		<p>{error}</p>
	</div>
) : doc && doc.props.length > 0 ? (
	<table class="prop-table">
		<thead>
			<tr>
				<th>Prop</th>
				<th>Type</th>
				<th>Default</th>
				<th>Description</th>
			</tr>
		</thead>
		<tbody>
			{doc.props.map((prop) => (
				<tr>
					<td>
						<span class="prop-table__name">{prop.name}</span>
						{prop.required && <span class="prop-table__required"> *</span>}
					</td>
					<td>
						<code class="prop-table__type">{prop.type}</code>
					</td>
					<td>
						{prop.defaultValue ? (
							<code class="prop-table__default">{prop.defaultValue}</code>
						) : (
							<span style="color: var(--sl-color-gray-4);">—</span>
						)}
					</td>
					<td class="prop-table__description">{prop.description || '—'}</td>
				</tr>
			))}
		</tbody>
	</table>
) : (
	<p><em>This component has no custom props. It accepts all standard HTML attributes for its base element.</em></p>
)}

<style>
	.prop-table-error {
		padding: 1rem;
		background: hsl(0, 60%, 94%);
		border: 1px solid hsl(0, 72%, 44%);
		color: hsl(0, 72%, 44%);
		font-size: 0.875rem;
	}

	:global([data-theme='dark']) .prop-table-error {
		background: hsl(0, 40%, 14%);
		border-color: hsl(0, 68%, 52%);
		color: hsl(0, 68%, 52%);
	}
</style>

